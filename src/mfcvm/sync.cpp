//---------------------------------------------------------------------------
//
//	X68000 EMULATOR "XM6"
//
//	Copyright (C) 2001-2004 ＰＩ．(ytanaka@ipc-tokai.or.jp)
//	[ 同期オブジェクト ]
//
//---------------------------------------------------------------------------

#include "os.h"
#include "xm6.h"
#include "sync.h"

#if defined(_WIN32)

//===========================================================================
//
//	同期オブジェクト
//
//===========================================================================

//---------------------------------------------------------------------------
//
//	コンストラクタ
//
//---------------------------------------------------------------------------
Sync::Sync()
{
	// クリティカルセクション作成
	csect = new CCriticalSection;
}

//---------------------------------------------------------------------------
//
//	デストラクタ
//
//---------------------------------------------------------------------------
Sync::~Sync()
{
	// ロックして
	Lock();

	// クリティカルセクション削除
	ASSERT(csect);
	delete csect;
	csect = NULL;
}

//---------------------------------------------------------------------------
//
//	ロック
//
//---------------------------------------------------------------------------
void FASTCALL Sync::Lock()
{
	ASSERT(csect);

	csect->Lock();
}

//---------------------------------------------------------------------------
//
//	アンロック
//
//---------------------------------------------------------------------------
void FASTCALL Sync::Unlock()
{
	ASSERT(csect);

	csect->Unlock();
}

#endif	// _WIN32
